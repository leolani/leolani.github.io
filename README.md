# leolani.github.io
Website for Github organization

This repository contains the source documents for the [leolani.github.io](https://leolani.github.io) pages.

## Goal of these GitHub pages

The goal of this repository is to document and organize **all** our repositories, regardless of their maturity or level of activity: all repositories are welcome, whether they accompany a publication or published software, or whether they are work in progress, or even premature repositories. The GitHub pages are thus not only intended for finished, presentable code, but also for repositories that might otherwise be forgotten, and become deadwood.

If you create a CLTL repository, mention it in a suitable place in the GitHub Pages, or create a place for it!

## Repository Setup

The CLTL pages are now built with [Docusaurus](https://docusaurus.io/en/).

Compared to the previous version, which was based on [Jekyll](https://jekyllrb.com/), we lose the ability of listing repositories by tag, but gain a simpler site structure.

The setup on GitHub is a bit peculiar however, and involves two distinct branches, `main` and `source-docs`:

* `main`: this branch contains the html pages. These pages are generated by Docusaurus, so you should not commit anything here through `git`, as it will be overwritten by the next website deployment.
* `source-docs`: this branch contains the contents of this site, and is where you will pull/push your commits. 

### README and ME 

This repository contains two README files (on `source-docs`):

* this README contains information on the GitHub setup of this website, and instructions to modify the content, commit changes and publish them.
* The [README located in `website`](https://github.com/cltl/cltl.github.io/blob/source-docs/website/README.md) was generated by Docusaurus. It provides additional information on content modification and pointers to the Docusaurus documentation.

## Contributing to this website

Contributing to this website requires two steps:

- [Modifying the contents](#modifying-the-contents). You only need `git` for this in principle.
- [Publishing the site](#publishing-the-site). This step is optional as I (Sophie) will redeploy the website when needed. Follow these instructions if you would like to build the site locally. 

## Modifying the contents

### Git actions 

Clone this repository, and checkout the `source-docs` branch

```sh
git clone https://github.com/cltl/cltl.github.io
cd cltl.github.io
git checkout source-docs
```

If you cloned the repository earlier, go to the `source-docs` branch and pull the latest version

```sh
git checkout source-docs
git pull
```

**Collaborative precautions**. You should make changes in a local branch to prevent clashes when pushing your commits. Create a local branch, e.g. `mybranch`:

```sh
git checkout -b mybranch
```

You can now access and modify the content in `docs`. You will find below instructions on: 

- [Modifying an existing page](#modifying-an-existing-page)
- [Adding a page](#adding-a-page-to-an-existing-category)
- [Adding a category](#adding-a-category-section)

Now you can commit your changes on `mybranch`, go back to the `source-docs` branch, update its contents and merge your commit:

```sh
git add --all
git commit -m "message for your commit"
git checkout source-docs
git pull 			# in case somebody else pushed new commits in the meantime...
git merge mybranch 
```

If somebody else made a commit while you were busy, you might have to resolve conflicts when merging `mybranch` (and merge your changes manually).

Push your changes to the `source-docs` branch when you are done.

```sh
git push -u origin source-docs
```

You can now delete `mybranch` by running:

```sh
git branch -d mybranch
```

### Modifying an existing page
#### Content pages

You will find content pages under `docs/<category>/<page-title>`. These are markdown files that you can edit.

#### Index page and footer

The index page for the website is located in `website/pages/en/index.js`. This is a React/Javascript file, that you can also edit. 
The footer of the website can be modified through `website/core/Footer.js`.
You can [initialize a (separate) docusaurus project](https://docusaurus.io/docs/en/installation) to get a richer example for the index or the footer.

### Adding a page to an existing category

You will find that category's folder under `docs/<category>`. Add a markdown file `<page-name>.md` for your page there. The name is not important, as it is the 'page id' that serves for linking documents through the site. The file should have the following header:

```md
---
id: <page-id>
title: <page-title>
---
```

You should link this page by adding its category and id to the file `./website/sidebars.json`. Subcategories for the sidebar can be specified directly in this file. 

### Adding a category section

We now have three categories: `research`, `resources`, and `teaching`.

To create a new category:

* Create a new folder under `docs`, e.g. `new-category`. This is not required for the website, but only to keep a clean project structure.
* Add a new page for this category, e.g. `new-page.md` with id `new-page`.
* Modify the file `./website/siteConfig.js` to add a tab for that category and link it to the first document in it: look for `headerLinks`, and add a line `{doc: 'new-category/new-page', label: 'LabelForThisCategory'}`.
* Link the page by adding it to the `./website/sidebars.json` file.


## Publishing the site

### Requirements

You will need `Node >= 8.x` and `Yarn >= 1.5` for this. Follow [these instructions](https://classic.yarnpkg.com/en/docs/install#mac-stable) for installing Yarn; `Node` is probably already installed on your system, follow [these instructions](https://nodejs.org/en/download/) otherwise.


### Instructions

Go to the `website` folder in the previously cloned `source-docs` branch, and set it up for Docusaurus:

```sh
cd website
yarn install  # this is needed only once after cloning the repository
```

You can view the website locally (on <http://localhost:3000>) by running

```sh
yarn start
```

Generate the website pages by running

```sh
yarn build
```

If this goes well, you are now ready to deploy the website on <https://cltl.github.io/>. Run

```sh
GIT_USER=<GIT_USER> CURRENT_BRANCH=main yarn run publish-gh-pages
```

where <GIT_USER> is your GitHub username.

If all goes well, the build will be pushed to the `main` branch, with a reference to the current `source-docs` commit. It is therefore important (for a clean git history) that you commit your changes on the `source-docs` branch **before** deploying the website.
